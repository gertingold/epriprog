
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8. Numerische Programmbibliotheken am Beispiel von NumPy/SciPy &#8212; Einführung in Prinzipien der Programmierung</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" />
    <link rel="next" title="9. Objektorientiertes Programmieren" href="objektorientiert.html" />
    <link rel="prev" title="7. Ein- und Ausgabe" href="einausgabe.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Einführung in Prinzipien der Programmierung</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="einleitung.html">
   1. Einleitung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vorschau.html">
   2. Eine Vorschau
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datentypen.html">
   3. Einfache Datentypen, Variablen und Zuweisungen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kontrollstrukturen.html">
   4. Kontrollstrukturen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="funktionen.html">
   5. Funktionen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sequenzen.html">
   6. Zusammengesetzte Datentypen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="einausgabe.html">
   7. Ein- und Ausgabe
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   8. Numerische Programmbibliotheken am Beispiel von NumPy/SciPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="objektorientiert.html">
   9. Objektorientiertes Programmieren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zahlensysteme.html">
   10. Anhang: Zahlensysteme
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="floats.html">
   11. Anhang: 64-Bit-Gleitkommazahlen nach IEEE-Standard 754
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="unicode.html">
   12. Anhang: Unicode
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
            title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/scipy.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Notebook-Datei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/scipy.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Vollbildmodus"
                title="Vollbildmodus"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/gertingold/epriprog/master?urlpath=tree/epriprog/scipy.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Starten Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Inhalt
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   8.1. Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays-und-anwendungen">
   8.2. Arrays und Anwendungen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerische-integration">
   8.3. Numerische Integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integration-gewohnlicher-differentialgleichungen">
   8.4. Integration gewöhnlicher Differentialgleichungen
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="numerische-programmbibliotheken-am-beispiel-von-numpy-scipy">
<span id="scipy"></span><h1><span class="section-number">8. </span>Numerische Programmbibliotheken am Beispiel von NumPy/SciPy<a class="headerlink" href="#numerische-programmbibliotheken-am-beispiel-von-numpy-scipy" title="Link zu dieser Überschrift">¶</a></h1>
<div class="warning admonition">
<p class="admonition-title">Hinweis</p>
<p>Dieses Kapitel befindet sich noch in Bearbeitung.</p>
</div>
<p>In den bisherigen Kapiteln hatten wir immer wieder Gelegenheit, auf
Möglichkeiten hinzuweisen, die die Python-Standardbibliothek bietet. Wenn man
die dort zur Verfügung gestellten Module verwendet, kann man sich Einiges an
Arbeit sparen und dabei auch den Code effizienter und übersichtlicher
gestalten.  Neben der Python-Standardbibliothek gibt es aber auch noch viele
interessante Programmpakete, die häufig über den <a class="reference external" href="https://pypi.org/">Python Package
Index</a> zur Verfügung gestellt werden.</p>
<p>Gerade für Problemstellungen in den Natur- und Ingenieurwissenschaften gibt es
eine oft als <em>scientific ecosystem of Python</em> oder <em>scientific stack</em>
bezeichnete Sammlung von zentralen Paketen. Hierzu gehört als Basispaket
zunächst <a class="reference external" href="http://numpy.org/">NumPy</a>, das den Datentyp <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> sowie Methoden
zur Verfügung stellt, um mit <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>-Objekten zu arbeiten. Damit wird das
Rechnen mit Vektoren und Matrizen ermöglicht, das wir bei der Besprechung von
Listen in <a class="reference internal" href="sequenzen.html#listen"><span class="std std-numref">Kapitel 6.1</span></a> vermisst hatten.</p>
<p>Ein weiteres wichtiges Paket ist <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/">SciPy</a>, das vielfältige numerische Werkzeuge zur Verfügung stellt, beispielsweise
zur numerischen Integration oder der Lösung von Differentialgleichungssystemen,
zur Lösung von Optimierungsproblemen oder zur Berechnung von speziellen
Funktion sowie vielem Anderem mehr. In diesem Kapitel werden wir einen
ersten Eindruck von den Möglichkeiten geben, die NumPy und SciPy bereitstellen.</p>
<p>Weitere zentrale Pakete, die in diesem Zusammenhang zu nennen sind, wären
<a class="reference external" href="http://matplotlib.org/">Matplotlib</a> zur graphischen Darstellung von Daten,
<a class="reference external" href="http://ipython.org/">IPython</a>, eine interaktive Python-Konsole, die für das
<a class="reference external" href="https://jupyter.org/">Projekt Jupyter</a>, das unter anderem die Jupyter
Notebooks zur Verfügung stellt, von zentraler Bedeutung war und ist,
<a class="reference external" href="http://sympy.org/">SymPy</a> für das symbolische Rechnen sowie das im
<a class="reference internal" href="einausgabe.html#readfile"><span class="std std-numref">Kapitel 7.2</span></a> bereits erwähnte <a class="reference external" href="http://pandas.pydata.org/">pandas</a>,
das fortgeschrittene Datenstrukturen und vielfältige Methoden zu einer
effizienten Datenanalyse bereithält.</p>
<p>Auf der Basis dieser Pakete haben einzelne wissenschaftliche Disziplinen
umfangreiche, auf ihre speziellen Bedürfnisse zugeschnittene Programmpakete
entwickelt. So kann <a class="reference external" href="https://www.astropy.org/">Astropy</a> als Standard in der
Astronomie angesehen werden. <a class="reference external" href="http://qutip.org/">QuTiP</a>, die <em>Quantum Toolbox
in Python</em> erlaubt die Simulation von Quantensystemen. Für Problemstellungen,
die sich mit finite-Elemente-Methoden lösen lassen, steht
<a class="reference external" href="https://fenicsproject.org/">FEniCS</a> zur Verfügung. Diese Aufzählung könnte
fast beliebig fortgesetzt werden und soll nur dazu dienen, einen allerersten
Eindruck von der Vielfalt der zur Verfügung stehenden
Python-Programmbibliotheken zu geben.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition seealso">
<p class="admonition-title">Siehe auch</p>
<p>Quellen für hier besprochene Programmpakete:
<a class="reference external" href="https://github.com/numpy/numpy">NumPy auf Github</a>,
<a class="reference external" href="https://github.com/scipy/scipy">SciPy auf Github</a></p>
</div>
</div>
<p>Nachdem die Benutzung professioneller Programmpakete gelegentlich mit hohen
Kosten verbunden sein kann, ist es erwähnenswert, dass die hier aufgeführten
Pakete frei verfügbar, aber dennoch von sehr hoher Qualität sind. Zwei Beispiele
prominenter Forschungsprojekte, deren Arbeit wesentlich auf einigen der hier
genannten Pakete, sind in <a class="reference internal" href="einleitung.html#warumpython"><span class="std std-numref">Kapitel 1.2</span></a> genannt. Darüber hinaus ist
der Quellcode der Pakete verfügbar, so dass man sich bei Bedarf auch die
konkrete Implementierung ansehen sowie zur Weiterentwicklung beitragen kann.</p>
<div class="section" id="installation">
<h2><span class="section-number">8.1. </span>Installation<a class="headerlink" href="#installation" title="Link zu dieser Überschrift">¶</a></h2>
<p>Da NumPy und SciPy nicht in der Python-Standardbibliothek enthalten sind, stehen
diese Programmpakete auch bei einer vorhandenen Python-Installation nicht
automatisch zur Verfügung. Dies lässt sich leicht überprüfen, indem man versucht,
die beiden Pakete zu importieren. Schlägt dies fehl, so erhält man einen
<code class="docutils literal notranslate"><span class="pre">ImportError</span></code>, der impliziert, dass Python die Pakete nicht finden kann.
Außerdem lässt sich die installierte Version anzeigen, was deswegen interessant
sein kann, weil gelegentlich neue Funktionalität zu den Paketen hinzugefügt
wird. Beachten Sie, dass vor und nach <code class="docutils literal notranslate"><span class="pre">version</span></code> jeweils zwei Unterstriche
stehen müssen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">numpy</span><span class="o">.</span><span class="n">__version__</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">scipy</span><span class="o">.</span><span class="n">__version__</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.__version__ = &#39;1.19.2&#39;
scipy.__version__ = &#39;1.5.2&#39;
</pre></div>
</div>
</div>
</div>
<p>Eine einfache und empfehlenswerte Möglichkeit, NumPy und SciPy unter Windows,
MacOS oder Linuxvarianten wie Ubuntu verfügbar zu machen, besteht darin, die
<a class="reference external" href="https://www.anaconda.com/products/individual">Anaconda-Distribution</a> zu
installieren. Dabei werden allerdings gleichzeitig zahlreiche andere, für
wissenschaftliche Zwecke interessante Programmpakete installiert.  Ist dies
nicht erwünscht, zum Beispiel wegen des relativ großen Bedarfs an
Speicherplatz, kann man NumPy und SciPy auch gezielt auf einem der Wege
installieren, die in der <a class="reference external" href="https://numpy.org/install/">Installationsanleitung für
NumPy</a> und der <a class="reference external" href="https://www.scipy.org/install.html">Installationsanleitung für
SciPy</a> beschrieben sind.</p>
</div>
<div class="section" id="arrays-und-anwendungen">
<h2><span class="section-number">8.2. </span>Arrays und Anwendungen<a class="headerlink" href="#arrays-und-anwendungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Für die Arbeit mit dem NumPy-Paket ist es üblich, für <code class="docutils literal notranslate"><span class="pre">numpy</span></code> die Abkürzung
<code class="docutils literal notranslate"><span class="pre">np</span></code> einzuführen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Dies bedeutet, dass man bei der Verwendung von NumPy vor die entsprechenden
Funktionen jeweils <code class="docutils literal notranslate"><span class="pre">np.</span></code> setzen muss. Diese Abkürzung verringert den Tippaufwand
und macht zum anderen sofort erkenntlich, wenn es sich um eine Funktion aus dem
NumPy-Paket handelt. Dies ist unter anderem deswegen wichtig, weil NumPy unter
anderem auch Funktionen wie die Exponentialfunktion <code class="xref py py-func docutils literal notranslate"><span class="pre">exp()</span></code> zur Verfügung
stellt, die von der Exponentialfunktion aus dem <code class="docutils literal notranslate"><span class="pre">math</span></code>-Modul unterschieden werden
muss.</p>
<p>Das zentrale Objekt, das durch das NumPy-Paket zur Verfügung gestellt wird, ist
das <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, wobei die Abkürzung für N-dimensionales Array steht. Hiermit lassen
sich also Vektoren und Matrizen von im Prinzip beliebiger Dimension darstellen,
wobei alle Einträge vom gleichen Datentyp sind.</p>
<p>Es gibt eine ganze Reihe von Möglichkeiten, solche Arrays zu konstruieren. Wir
beginnen damit eine Matrix aus einer Liste oder im Allgemeinen Listen von Listen
zu erzeugen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrixA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">matrixA</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt;
[[ 1.3  2.5]
 [-1.7  3.9]]
</pre></div>
</div>
</div>
</div>
<p>Für <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>s ist eine Matrixmultiplikation definiert. Um dies zu demonstrieren,
definieren wir ein zweites Array und führen die Matrixmultiplikation aus. Dafür
können wir die Funktion <code class="docutils literal notranslate"><span class="pre">np.dot</span></code> verwenden oder den <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>-Operator, der in moderneren
Versionen des NumPy-Pakets definiert ist. Anschließend überprüfen wir das Ergebnis
am 00-Element.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrixB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixA</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixA</span> <span class="o">@</span> <span class="n">matrixB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrixA</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">matrixB</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> + </span><span class="si">{</span><span class="n">matrixA</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">matrixB</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> = &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrixA</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">matrixB</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">matrixA</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">matrixB</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.3  2.5]
 [-1.7  3.9]]

[[ 2.1 -4.5]
 [ 0.9 -2.1]]

[[  4.98 -11.1 ]
 [ -0.06  -0.54]]

1.3*2.1 + 2.5*0.9 = 4.98
</pre></div>
</div>
</div>
</div>
<p>Dabei zeigen die letzten beiden Zeilen, wie man Elemente des Arrays adressieren
kann, nämlich indem die Indizes für die einzelnen Dimensionen durch Komma getrennt
in eckigen Klammern angegeben werden.</p>
<div class="warning admonition">
<p class="admonition-title">Multiplikationsoperatoren &#64; und *</p>
<p>Beachten Sie, dass der normale Multiplikationsoperator <code class="docutils literal notranslate"><span class="pre">*</span></code> die beiden Matrizen
elementweise multipliziert und somit keine Matrixmultiplikation ausführt, wie
es <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> verlangt. Probieren Sie es an einem Beispiel selbst aus!</p>
</div>
<p>Wie bei Listen kann die Adressierung auch mit Hilfe von Slices erfolgen, so dass
man bequem Untermatrizen extrahieren kann. Wichtig dabei ist, dass hier kein neues
Array erzeugt wird, sondern nur eine andere Sicht auf das bereits existierende Array
bereitgestellt wird. Dadurch ist ein solcher Zugriff sehr effizient. In diesem
Beispiel verwenden wird zur schnellen Erzeugung eines etwas größeren Arrays die
<code class="xref py py-func docutils literal notranslate"><span class="pre">arange()</span></code>-Funktion, die mit mit <code class="xref py py-func docutils literal notranslate"><span class="pre">range()</span></code> vergleichbar ist, aber eben ein
zunächst eindimensionales Array erzeugt. Dieses können wir dann mit der
<code class="xref py py-func docutils literal notranslate"><span class="pre">reshape()</span></code>-Methode beispielsweise in ein zweidimensionales Array umwandeln.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrixC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0  1  2  3  4  5]
 [ 6  7  8  9 10 11]
 [12 13 14 15 16 17]
 [18 19 20 21 22 23]
 [24 25 26 27 28 29]
 [30 31 32 33 34 35]]

[[ 9 10]
 [15 16]]
</pre></div>
</div>
</div>
</div>
<p>In der letzten Zeile extrahieren wir eine Untermatrix. Dabei bezieht sich das erste
Slice auf die Zeilen und das zweite Slice auf die Spalten. So können wir auch eine
Zerlegung in Blockmatrizen vornehmen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">[</span><span class="mi">3</span><span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">[</span><span class="mi">3</span><span class="p">:,</span> <span class="mi">3</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0  1  2]
 [ 6  7  8]
 [12 13 14]]

[[ 3  4  5]
 [ 9 10 11]
 [15 16 17]]

[[18 19 20]
 [24 25 26]
 [30 31 32]]

[[21 22 23]
 [27 28 29]
 [33 34 35]]
</pre></div>
</div>
</div>
</div>
<p>Zudem kann die Möglichkeit eines Slices, die Schrittweite anzugeben, verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">matrixC</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0  3]
 [12 15]
 [24 27]]
</pre></div>
</div>
</div>
</div>
<p>Während wir bei Listen gewohnt sind, diese mit der <code class="xref py py-func docutils literal notranslate"><span class="pre">append()</span></code>-Methode um weitere
Elemente zu erweitern, sollte man ein solches Vorgehen bei Arrays vermeiden. Da dabei
jeweils ein neues Array erzeugt wird, wäre ein solches Vorgehen äußerst ineffizient.
Stattdessen legt man das Array zunächst in der benötigten Größe an, zum Beispiel mit
Hilfe von <code class="xref py py-func docutils literal notranslate"><span class="pre">np.zeros()</span></code> oder <code class="xref py py-func docutils literal notranslate"><span class="pre">np.ones()</span></code>. Das folgende Beispiel illustriert,
wie man die Dimension des Arrays sowie den Datentyp festlegen kann und was die
Multiplikation des Arrays mit einer Zahl bedeutet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[5, 5, 5, 5],
        [5, 5, 5, 5],
        [5, 5, 5, 5]],

       [[5, 5, 5, 5],
        [5, 5, 5, 5],
        [5, 5, 5, 5]]])
</pre></div>
</div>
</div>
</div>
<div class="warning admonition">
<p class="admonition-title">Integer-Arrays</p>
<p>Bei Python sind wir gewohnt, dass Integer im Prinzip beliebig groß werden können.
Bei <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>s mit Datentyp Integer ist dies nicht der Fall. Der mögliche
Zahlenbereich ist je nach dem gewählten Integertyp eingeschränkt. Genaueres hierzu
findet man in der <a class="reference external" href="https://numpy.org/doc/stable/user/basics.types.html">NumPy-Dokumentation zu Datentypen</a>.</p>
</div>
<p>Statt NumPy-Arrays im Detail zu diskutieren, wollen wir im Folgenden einen Eindruck von
einigen Möglichkeiten geben, die dieser Datentyp bietet. Für die Arbeit mit <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>s
sollten man sich aber auf jeden Fall genauer mit diesen vertraut machen. Wir verweisen
hierzu zum Beispiel auf die <a class="reference external" href="https://numpy.org/doc/stable/">NumPy-Dokumentation</a>, aber auch
auf <a class="reference external" href="https://youtu.be/R2rCYf3pv-M">Teil 1</a> und <a class="reference external" href="https://youtu.be/sunNXIxIGV8">Teil 2</a> eines
Videotutorials.</p>
<p>Zu Beginn des Kapitels hatten wir gesehen, wie man Matrizen miteinander multiplizieren kann.
Für Vektoren erhält man auf diese Weise unmittelbar das Skalarprodukt. Darüber hinaus kann man
auch das Kreuzprodukt und das dyadische Produkt mit Hilfe von NumPy berechnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vecA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">vecB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vecA</span><span class="p">,</span> <span class="n">vecB</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">vecA</span><span class="p">,</span> <span class="n">vecB</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">vecA</span><span class="p">,</span> <span class="n">vecB</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2

[ 0  0 23]

[[ 10   8   0]
 [-15 -12   0]
 [  0   0   0]]
</pre></div>
</div>
</div>
</div>
<p>Statt <code class="xref py py-func docutils literal notranslate"><span class="pre">np.dot()</span></code> hätten wir natürlich auch wieder den <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>-Operator verwenden können.</p>
<p>Interessant sind die von NumPy zur Verfügung gestellten <em>universal functions</em> oder <em>ufuncs</em>,
die als Argumente NumPy-Arrays akzeptieren und damit effizient Funktionen in einem Schritt
für eine größere Anzahl von Argumenten auswerten können. In dem folgenden Beispiel demonstrieren
wir zugleich die Verwendung der <code class="xref py py-func docutils literal notranslate"><span class="pre">linspace()</span></code>-Funktion, um eine Liste äquidistanter Werte
zu erzeugen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.  0.2 0.4 0.6 0.8 1.  1.2 1.4 1.6 1.8 2. ]
[1.         1.22140276 1.4918247  1.8221188  2.22554093 2.71828183
 3.32011692 4.05519997 4.95303242 6.04964746 7.3890561 ]
</pre></div>
</div>
</div>
</div>
<p>Die Exponentialfunktion aus dem <code class="docutils literal notranslate"><span class="pre">math</span></code>-Modul ist dagegen nicht in der Lage, NumPy-Arrays als
Argument zu akzeptieren.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">6294</span><span class="n">dfbcf095</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">math</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="ne">TypeError</span>: only size-1 arrays can be converted to Python scalars
</pre></div>
</div>
</div>
</div>
<p>An dieser Stelle wird deutlich, wie nützlich es sein kann, aus dem Code direkt ersehen zu
können, aus welchem Modul die Exponentialfunktion verwendet wird. Das NumPy-Paket stellt
<em>ufuncs</em> für die üblichen Standardfunktionen zur Verfügung. Für viele spezielle Funktionen
wird man im SciPy-Paket fündig.</p>
<p>Zum Abschluss dieses kurzen Einblicks in das NumPy-Paket wollen wir noch einen Blick auf
häufig benötigte Funktionen aus der linearen Algebra werfen. Diese befinden sich im <code class="docutils literal notranslate"><span class="pre">linalg</span></code>-Modul
von NumPy, das üblicherweise unter dem Namen <code class="docutils literal notranslate"><span class="pre">LA</span></code> importiert wird.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">LA</span>
</pre></div>
</div>
</div>
</div>
<p>Für die Beispiele verwenden wir der Übersichtlichkeit halber nur 2×2-Matrizen, für die wir
alle Rechnungen natürlich auch leicht analytisch durchführen könnten. Selbstverständlich kann
NumPy auch mit viel größeren Matrizen umgehen. Wir definieren also eine 2×2-Matrix und berechnen
zunächst ihre Determinante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LA</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<p>Als nächstes berechnen wir die Inverse und obwohl bei diesem Wert der Determinante die Korrektheit
des Ergebnisses mehr oder weniger offensichtlich ist, berechnen wir gleich noch das Produkt
aus der Matrix und ihrer Inversen, das erwartungsgemäß die Einheitsmatrix ergibt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_inv</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a_inv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">a_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-5.  3.]
 [ 2. -1.]]
[[1. 0.]
 [0. 1.]]
</pre></div>
</div>
</div>
</div>
<p>Für Anwendungen sehr wichtig ist die Möglichkeit, Eigenwertprobleme zu lösen. Berechnen wir also
die Eigenwerte und Eigenvektoren der Matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigenwerte</span><span class="p">,</span> <span class="n">eigenvektoren</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenwerte</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenwerte</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">eigenwerte</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenvektoren</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.16227766  6.16227766]
-0.9999999999999984
[[-0.93246475 -0.50245469]
 [ 0.36126098 -0.86460354]]
</pre></div>
</div>
</div>
</div>
<p>der zweiten Ausgabezeile entnehmen als ersten Test, dass das Produkt der Eigenwerte, bis auf
Rundungsfehler, gleich der oben erhaltenen Determinanten ist. Überprüfen wir zum Abschluss noch
die Korrektheit der Eigenvektoren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">eigenvektoren</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">],</span>
          <span class="n">eigenwerte</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">eigenvektoren</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.1513182  -0.05862459] [ 0.1513182  -0.05862459]
[-3.09626531 -5.32792709] [-3.09626531 -5.32792709]
</pre></div>
</div>
</div>
</div>
<p>Da der erste Index des Array <code class="docutils literal notranslate"><span class="pre">eigenvektoren</span></code> der Zeilenindex ist, während der zweite Index der
Spaltenindex ist, sehen wir, dass die Eigenvektoren in diesem Array in den Spalten stehen.</p>
</div>
<div class="section" id="numerische-integration">
<h2><span class="section-number">8.3. </span>Numerische Integration<a class="headerlink" href="#numerische-integration" title="Link zu dieser Überschrift">¶</a></h2>
<p>SciPy ist eine umfangreiche numerische Bibliothek, die wesentlich auf dem gerade besprochenen
NumPy-Paket basiert. Sie deckt vielfältige Problemstellungen ab wie zum Beispiel numerische
Integration und Lösung von gewöhnlichen Differentialgleichungen, Interpolation, Fouriertransformation,
Lösung von Optimierungsproblemen und Nullstellensuche, Signalverarbeitung oder spezielle
mathematische Funktionen. Hier wird es uns nur möglich sein, einen ersten Eindruck davon zu geben,
wie man mit Hilfe von SciPy numerische Problemstellungen lösen kann. Wir wollen dies anhand der
numerischen Auswertung von Integralen sowie der Lösung einer gewöhnlichen Differentialgleichung tun.</p>
<p>In diesem Kapitel wollen wir an zwei Beispielen die Auswertung von Integralen und zeigen und betrachten
zunächst das Integral</p>
<div class="math notranslate nohighlight">
\[J_0(1) = \frac{1}{\pi}\int_0^\pi\cos\!\big(\!\cos(x)\big)\text{d}x\,.\]</div>
<p>Das Ergebnis lässt sich durch eine spezielle Funktion, nämlich die Besselfunktion erster Gattung und
nullter Ordnung <span class="math notranslate nohighlight">\(J_0\)</span>, an der Stelle angeben. Mit Hilfe des SciPy-Pakets können wir sowohl das
Integral auf der rechten Seite als auch die Besselfunktion auf der linken Seite unabhängig voneinander
auswerten lassen und die beiden Ergebnisse miteinander vergleichen. Betrachten wir zunächst die
numerische Integration. Hierfür steht im <code class="docutils literal notranslate"><span class="pre">integrate</span></code>-Modul die Funktion <code class="xref py py-func docutils literal notranslate"><span class="pre">quad()</span></code> zur Verfügung,
die als wesentliche Argumente den Integranden und die Integrationsgrenzen erwartet. Darüber hinaus
gibt es noch weitere Argumente, die wir hier einfach auf ihren Defaultwerten belassen. Den Integranden
stellen wir mit Hilfe einer Lambdafunktion zur Verfügung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="n">resultat</span><span class="p">,</span> <span class="n">fehler</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cos</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultat</span><span class="p">,</span> <span class="n">fehler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7651976865579665 7.610963315273956e-11
</pre></div>
</div>
</div>
</div>
<p>Wir erhalten sowohl das Resultat des numerischen Fehlers als auch eine Abschätzung für den absoluten
Integrationsfehler.</p>
<p>Zum Vergleich werten wir die Besselfunktion <span class="math notranslate nohighlight">\(J_0\)</span> nun direkt an der Stelle 1 aus. Dazu importieren
wir die entsprechende Funktion aus dem <code class="docutils literal notranslate"><span class="pre">special</span></code>-Modul von SciPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">j0</span>

<span class="nb">print</span><span class="p">(</span><span class="n">j0</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7651976865579665
</pre></div>
</div>
</div>
</div>
<p>In diesem Fall stimmen die beiden Ergebnisse perfekt überein, was aber im Allgemeinen nicht erwartet
werden kann. Problematisch sind insbesondere Integranden, die Singularitäten enthalten oder sehr
schnell oszillieren.</p>
<p>Um zu demonstrieren, dass SciPy auch mit uneigentlichen Integralen umgehen kann, betrachten wir noch
das Integral</p>
<div class="math notranslate nohighlight">
\[\int_{-\infty}^\infty\frac{1}{x^2+1}\text{d}x = \pi\,,\]</div>
<p>dessen Wert man ebenfalls analytisch kennt. Dies erlaubt uns wiederum, einen Eindruck davon zu gewinnen,
wie gut das Integrationsergebnis ist. Um mit den Integrationsgrenzen umzugehen, verwenden wir die
Konstante <code class="docutils literal notranslate"><span class="pre">inf</span></code> aus NumPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">resultat</span><span class="p">,</span> <span class="n">fehler</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultat</span><span class="p">,</span> <span class="n">fehler</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793 5.155583041103855e-10
3.141592653589793
</pre></div>
</div>
</div>
</div>
<p>Auch in diesem Fall ist die Übereinstimmung perfekt, so dass wir nochmals betonen wollen, dass dies
im Allgemeinen keineswegs zu erwarten ist.</p>
<p>Neben der Funktion <code class="xref py py-func docutils literal notranslate"><span class="pre">quad()</span></code> stellt noch weitere Funktionen zur Verfügung, in denen zum Beispiel
andere Integrationsverfahren verwendet werden oder mit denen auch mehrdimensionale Integrale
berechnet werden können. Weitere Informationen findet man in der <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#integrating-functions-given-function-object">Dokumentation des
<code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code>-Moduls</a>.</p>
</div>
<div class="section" id="integration-gewohnlicher-differentialgleichungen">
<h2><span class="section-number">8.4. </span>Integration gewöhnlicher Differentialgleichungen<a class="headerlink" href="#integration-gewohnlicher-differentialgleichungen" title="Link zu dieser Überschrift">¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="einausgabe.html" title="previous page"><span class="section-number">7. </span>Ein- und Ausgabe</a>
    <a class='right-next' id="next-link" href="objektorientiert.html" title="next page"><span class="section-number">9. </span>Objektorientiertes Programmieren</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Gert-Ludwig Ingold<br/>
        
            &copy; Copyright 2020, 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>